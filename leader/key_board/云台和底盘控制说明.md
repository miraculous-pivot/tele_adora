# 云台、底盘和吸盘控制功能说明

## 概述
在现有的双臂机器人键盘控制节点中添加了云台（头部）控制、底盘控制和吸盘控制功能。

## 新增功能
### 云台控制
- **数字键1**: 云台向上（+Pitch，抬头）
- **数字键3**: 云台向下（-Pitch，低头）
- **数字键5**: 云台向左（+Yaw，左转）
- **数字键7**: 云台向右（-Yaw，右转）

### 底盘控制
- **数字键8**: 底盘前进
- **数字键2**: 底盘后退  
- **数字键4**: 底盘左转
- **数字键6**: 底盘右转

### 吸盘控制
- **字母键c**: 切换吸盘开关

### 吸盘控制
- **字母键c**: 切换吸盘开关（开/关）

## 技术细节
### 云台控制话题信息
- **话题名称**: `adora_robot/head/servo_cmd`
- **消息类型**: `geometry_msgs/Point`
- **消息格式**:
  - `x`: pitch值（俯仰角）
  - `y`: yaw值（偏航角） 
  - `z`: 未使用（保持为0）

### 吸盘控制话题信息
- **话题名称**: `/adora_robot/suction_pump/cmd`
- **消息类型**: `std_msgs/Bool`
- **消息格式**: `data: true`（开启）或 `data: false`（关闭）
- **状态反馈话题**: `/adora_robot/suction_pump/status`

### 底盘控制话题信息
- **话题名称**: `/dt/velocity_ctrl`
- **消息类型**: `geometry_msgs/Twist`
- **消息格式**:
  - `linear.x`: 前进/后退速度（m/s）
  - `angular.z`: 旋转速度（rad/s）
  - 其他字段未使用（保持为0）

### 参数配置
可通过以下参数调整控制速度：
- `head_pitch_speed`: 俯仰控制速度（默认: 0.05 rad/key_press）
- `head_yaw_speed`: 偏航控制速度（默认: 0.05 rad/key_press）
- `chassis_linear_speed`: 底盘线速度（默认: 0.5 m/s）
- `chassis_angular_speed`: 底盘角速度（默认: 0.5 rad/s）

## 使用方法
### 1. 启动测试节点（可选）
启动云台控制测试节点：
```bash
cd /home/feng/tele_adora/leader/key_board
python3 test_head_control.py
```

启动底盘控制测试节点：
```bash
cd /home/feng/tele_adora/leader/key_board  
python3 test_chassis_control.py
```

### 2. 启动键盘控制节点
```bash
cd /home/feng/tele_adora/leader/key_board
source install/setup.bash
ros2 run my_teleop_pkg bimanual_teleop
```

### 3. 控制操作
- 使用方向键控制云台运动
- 使用数字键8,2,4,6控制底盘运动
- 实时状态显示包含云台和底盘控制值
- 按空格键或ESC键退出时自动停止所有运动

## 状态显示
控制界面会实时显示：
```
Left Arm Vel: [x:+0.00, y:+0.00, z:+0.00, rx:+0.00, ry:+0.00, rz:+0.00] | Gripper: OPEN
Right Arm Vel:[x:+0.00, y:+0.00, z:+0.00, rx:+0.00, ry:+0.00, rz:+0.00] | Gripper: OPEN
Head Control: [Pitch:+0.000, Yaw:+0.000]
Chassis Control: [Linear:+0.00 m/s, Angular:+0.00 rad/s]
Suction Pump: OFF
Lifting Motor: Current:500mm | ⏸ STOPPED | Speed:5000mm/s | Max:700mm
```

## 注意事项
1. 数字键控制是瞬时的，按一次产生一个控制量
2. 云台、底盘和吸盘控制与其他控制功能（双臂、夹爪、升降）并行工作
3. 退出程序时会自动发送零值命令停止所有运动并关闭吸盘
4. 确保以下节点正在运行：
   - `ros2_head_control`节点：接收云台控制命令
   - `adora_a2_max_node`节点：接收底盘控制命令（通过adora_a2_max_ros2.launch.py启动）
   - `suction_pump_control_node`节点：接收吸盘控制命令

## 依赖关系
- 云台控制：依赖`ros2_head_control`包
- 底盘控制：依赖`adora_chassis_control`包中的adora_a2_max_ros2.launch.py
- 吸盘控制：依赖`adora_suction_pump_control`包

## 启动吸盘控制节点
在slave端启动吸盘控制节点：
```bash
cd /home/feng/tele_adora/slave/adora
source install/setup.bash
ros2 launch adora_suction_pump_control suction_pump_control.launch.py
```

或者直接运行节点：
```bash
ros2 run adora_suction_pump_control suction_pump_node
```
